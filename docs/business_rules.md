# Business rules

Below are listed the business rules that one would expect to be true in the data. Nevertheless, neither the processes nor the DBMS enforced them. Thus, they may have been violated giving rise to quality problems.

## Notes

- The identifiers at the beginning of the rules are meant to be set in stone. This number has no particular meaning and it is only used to reference to rules in the code.
- A checked checkbox means that the rule has been tested

## AMOS database

### Identifiers

- [ ] **R1**: workPackageID is an identifier of WorkPackage.
- [ ] **R2**: workOrderID is an identifier of WorkOrders/ForecastedOrders/TechnicalLogBookOrders.
- [ ] **R3**: maintenanceID is an identifier of MaintenanceEvents/OperationInterruption.
- [ ] **R4**: file is an identifier of Attachments.

### References

- [ ] **R5**: event of an Attachment is a reference to maintenanceID of MaintenanceEvents.

### Datatypes/Domains

- [ ] **R6**: subsystem of MaintenanceEvents should be a 4 digits ATA code. See ATA codes for commercial aircrafts in <https://en.wikipedia.org/wiki/ATA_100>
- [ ] **R7**: delayCode of OperationInterruption should be a 2 digits IATA code. See <https://en.wikipedia.org/wiki/IATA_delay_codes>
- [ ] **R8**: workPackageID/workOrderID/maintenanceID should be simply SERIAL numbers generated by an autoincrement mechanism. See <https://www.postgresql.org/docs/9.1/datatype-numeric.html#DATATYPE-NUMERIC-TABLE> for details.
- [ ] **R9**: ReportKind values “PIREP” and “MAREP” refer to pilot and maintenance personnel as reporters, respectively.
- [ ] **R10**: MELCathegory values A,B,C,D refer to 3,10,30,120 days of allowed delay in the repairing of the problem in the aircraft, respectively.
- [ ] **R11**: airport in MaintenanceEvents must have a value.
  - Since a maintenance event can't be generated by a flight_slot, and a maintenance_slot does not have an airport, we produce a random airport here.

### Other business rules

- [ ] **R12**: In OperationInterruption, departure must coincide with the date of the flightID (see bellow how it is composed).
  - This means that for a flight with flight id = "<some date>", this *date* is the one used as departure in the operation interruption
  - in a flightid, this date being used is the **scheduleddeparture**. TODO: Confirm this.
- [ ] **R13**: The flight registered in OperationInterruption, must exist in the Flights of AIMS database, and be marked as “delayed” (i.e., delayCode is not null) with the same IATA delay code.
- [ ] **R14**: In MaintenanceEvents, the events of kind Maintenance that correspond to a Revision, are those of the same aircraft whose interval is completely included in that of the Revision. For all of them, the airport must be the same.
  - [ ] My understanding of this is that for a given MaintenanceEvent "me" in AMOS, if the kind is "Revision", then there must be an instance of MaintenanceSlot, "ms" whose (ms.scheduled_arrival - ms.scheduled_departure) >= me.duration
  - [ ] these two instances must share the aircraft registration, me.aircraftregistration = ms.aircraftregistration
- [ ] **R24**: In MaintenanceEvents, the events of kind Maintenance cannot partially intersect that of a Revision of the same aircraft.
  - [ ] this means that for the same aircraft, there can't be two maintenance operations happening at the same point in time
  - [ ] this means a posterior check of the maintenance events
  - [ ] maintenance events have a starttime and a duration, so out of the final maintenance events, we need to filter out those
        of type _Revision_ and those of type _Maintenance_, and deal with those that are overlapping
- [ ] **R15**: In MaintenanceEvents, maintenance duration must have the expected length according to the kind of maintenance:
  - [ ] **R15-A**: Delay – minutes
  - [ ] **R15-B**: Safety – undetermined/unlimited,
  - [ ] **R15-C**: AircraftOnGround – hours
  - [ ] **R15-D**: Maintenance – hours to max 1 day
  - [ ] **R15-E**: Revision – days to 1 month

## AIMS database

### Identifiers:

- [ ] **R16**: flightID is an identifier of Flights.

### Datatypes/Domains:

- [ ] **R17**: flightID is derived by concatenating the following values: Date-Origin-Destination-FlightNumber-AircraftRegistration (lengths: 6+1+3+1+3+1+4+1+6=26).
- [ ] **R18**: delayCode in OperationInterruption is a 2 digits IATA code 2

### Other business rules:

- [ ] **R19**: In a Slot, scheduledArrival must be posterior to the scheduledDeparture.
- [ ] **R20**: Two Slots of the same aircraft cannot overlap.
- [ ] **R21**: In Flights, departure and arrival airports must be those in the flightID (unless this flight has been diverted).
- [ ] **R22**: In a Flight, actualArrival is posterior to actualDeparture.
- [ ] **R23**: In a Maintenance, the corresponding events must exist in AMOS inside the corresponding time interval.

## Configuration Requirements

These refer to any requirement related to control the data generation process.

- [x] **C1**: Users can select how many rows they wish
